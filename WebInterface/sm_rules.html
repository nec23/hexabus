<!DOCTYPE HTML>
<html>                                                                  
 <head>                                                                  
 <script type="text/javascript" src="jquery.js"></script>          
 </head>                                                                 
 <body>                                                                  
	 <div id="condconfig">
		 <p><b>Condition:</b></p> 
		<select><option value="0">Received data from</option><option value="1">Date/Time</option></select>
		<b>IP</b><input name="ip" type="text" />
		<b>with value</b><select id="operator"></select><input id="inputval" type="text" />
		<p><button id="addcond">Add this condition</button><button name="reset">Reset</button></p>
		<h3>Conditions:</h3>
		<div id="conds"></div>
	</div>
	<hr>
	<div id="ruleconfig">
		 <p><b>If</b> <span name="ifselectors"></span><br /> <button name="addif">Add Condition</button></p> 
		 <p><b>While</b> <span name="whileselectors"></span><br /> <button name="addwhile">Add Condition</button></p>
		<p><b>Then Write</b> <input name="value" type="text" /> <b>to Endpoint ID</b> <input name="eid" type="text" /></p>
		<button name="addrule">Add this Rule</button><button name="reset">Reset</button>
	</div>
	<h3>Rules:</h3>
	<div id="rules"></div>
</body>                                                                 
 <script type="text/javascript">                                         
	 function printJSON(jsonText, i) {
		 $("#rules").append("<b>If</b> " + rules[i].ifCond + " <b>While</b> " + rules[i].whileCond + " <b>Then Write</b> " + rules[i].value + " <b>to EID</b> " + rules[i].eid + "<br />");
	 }
	 
	 var rules = new Array();
	 $('button[name="addif"]').click(function() {
			$('span[name="ifselectors"]').append('<select><option value="0">Cond 0</option><option value="1">Cond 1</option></select>');
			});
 	$('button[name="addwhile"]').click(function() {
			$('span[name="whileselectors"]').append('<select><option value="0">Cond 0</option><option value="1">Cond 1</option></select>');
			});
	$('button[name="reset"]').click(function() {
			$("span").html("");
			$("input").val("");
			});
	$('button[name="addrule"]').click(function() {
			var tmpIfConds = '';
			var tmpWhileConds = '';
			$("#rules").append("<b>Rule#"+rules.length+":</b><br />");
			$('span[name="ifselectors"] select').each(function(index) {
				tmpIfConds += '"Cond ' + $(this).val() + '",';
				});
			$('span[name="whileselectors"] select').each(function(index) {
				tmpWhileConds += '"Cond ' + $(this).val() + '",';
				});
			rules.push(JSON.parse('{"ifCond" : [' + tmpIfConds.substr(0, tmpIfConds.length - 1) + '], "whileCond" : [' + tmpWhileConds.substr(0, tmpWhileConds.length - 1) + '], "value" :' + $("input[name=value]").val() + ', "eid" :' + $("input[name=eid]").val() + '}'));
			printJSON(rules, rules.length - 1);
			});
 </script>                                                               
 </html>
